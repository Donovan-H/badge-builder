<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-icons/editor-icons.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/Sortable/Sortable.html">

<link rel="import" href="quiz-ordered-list.html">

<link rel="import" href="scripts/lodash.html">

<script>
  window.QuizBehaviors = window.QuizBehaviors || {}; // Behavior namespace
  /** @polymerBehavior QuizBehaviors.MultiOrderableBehavior */
  QuizBehaviors.MultiOrderableBehaviorImpl = {

    properties: {
      _multiContainer: {
        type: Object
      },

      _sortableContainer: {
        type: Object
      },
    },

    ready: function() {
      // create container element
      this._multiContainer = document.createElement("div"); // ul
      this._multiContainer.classList.add("container");
      Polymer.dom(this).appendChild(this._multiContainer);
    },

    attached: function() {
      this._sortableContainer = Sortable.create(this._multiContainer, {
        animation: 200,
        handle: ".drag-handle"
      });
    },

    detatched: function() {
      if(this._sortableContainer){
        this._sortableContainer.destroy();
      }
    },

    _addOption: function(name){
      var el = document.createElement("quiz-ordered-list");
      el.classList.add('list');
      // set properties
      el._placeholder = "Group";
      el._dragHandle = "drag-group";

      this._addElement(el);
      return el;
    },

    _removeOption: function(name){
      console.log("REMOVE OPTION", name);
      return false;
    },

    _addElement: function(element){
      Polymer.dom(this._multiContainer).appendChild(element);
    },

    _removeElement: function(element){
      Polymer.dom(this._multiContainer).removeChild(element);
    },

    _onDeleteElement: function(e){
      if (e.target.localName === this.localName) {
        return;
      }
      // we are deleting a child element so we want to stop bubbling this event up the dom tree
      e.stopPropagation();
      console.info(this.localName, "[-] Delete child element:", e.target.localName);
      Polymer.dom(this._multiContainer).removeChild(e.target);
    },

    listeners: {
      'deleteElement': "_onDeleteElement"
    },

  };

  QuizBehaviors.MultiOrderableBehavior = [
    QuizBehaviors.MultiOrderableBehaviorImpl
  ];
</script>
